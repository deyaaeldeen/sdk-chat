// Copyright (c) Microsoft Corporation.
// Licensed under the MIT License.

package com.test.sdk;

import java.util.concurrent.CompletableFuture;

/**
 * A generic service response wrapper.
 *
 * <p>SOURCE LIMITATION: The source parser (JavaParser) sees the type parameters
 * and bounds syntactically, but cannot verify that {@code Comparable<T>} is from
 * {@code java.lang}. It records "Comparable" as a string reference and tries to
 * match it via import statements. If the import is implicit (java.lang.* is always
 * imported in Java), the source parser may fail to attribute it correctly.
 *
 * <p>COMPILED: ASM ClassReader reads the generic signature from bytecode, where
 * the full descriptor {@code Ljava/lang/Comparable<TT;>;} is present. The type
 * is unambiguously resolved.
 *
 * @param <T> The value type, which must be comparable.
 */
public class ServiceResponse<T extends Comparable<T>> {

    private final T value;
    private final int statusCode;
    private final String requestId;

    /**
     * Creates a new response.
     *
     * @param value      The response value.
     * @param statusCode The HTTP status code.
     * @param requestId  The request ID for tracing.
     */
    public ServiceResponse(T value, int statusCode, String requestId) {
        this.value = value;
        this.statusCode = statusCode;
        this.requestId = requestId;
    }

    /** Gets the response value. */
    public T getValue() { return value; }

    /** Gets the HTTP status code. */
    public int getStatusCode() { return statusCode; }

    /** Gets the request ID. */
    public String getRequestId() { return requestId; }
}

/**
 * A client interface with generic method signatures.
 *
 * <p>SOURCE LIMITATION: The bridge methods generated by the Java compiler for
 * generic type erasure are invisible to the source parser. For example, when a
 * class implements {@code Processor<String>}, the compiler generates a bridge
 * method {@code Object process(Object)} alongside the actual
 * {@code String process(String)}. The source parser only sees the declared method.
 *
 * <p>COMPILED: ASM sees BOTH the declared method and the bridge method (marked
 * with ACC_BRIDGE | ACC_SYNTHETIC flags). The compiled engine correctly
 * filters out bridge methods while confirming the declared generic signature.
 */
interface Processor<T> {
    /**
     * Processes an input.
     *
     * @param input The input to process.
     * @return The processed result.
     */
    T process(T input);
}
